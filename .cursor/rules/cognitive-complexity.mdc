---
alwaysApply: true
---

# Cognitive Complexity Rules (SonarQube Standard)

## Overview
All functions in this repository must adhere to SonarQube's Cognitive Complexity metric to ensure maintainability and readability.

## Maximum Complexity Threshold
- **Maximum allowed cognitive complexity per function: 15**
- Functions exceeding this threshold must be refactored
```typescript
function checkAndRecordTransition(
  currentNode: Node,
  nextNode: Node,
  list1: Node[],
  list2: Node[]
): number {
  let count = 0;

  // +1 (if) +1 (||) +1 (&&) = +3
  if ((currentNode.type === "A" || currentNode.type === "B") && nextNode.type === "C") {
    // +2 (nested if at level 1: +1 base + +1 nesting)
    if (!list1.some(n => n.name === nextNode.name)) {
      list1.push(nextNode);
      count++;
    }
  }

  // +1 (if) +1 (&&) = +2
  if (currentNode.type === "D" && nextNode.type === "E") {
    // +2 (nested if at level 1)
    if (!list2.some(n => n.name === currentNode.name)) {
      list2.push(currentNode);
      count++;
    }
  }

  return count;
}
// Complexity: 3 + 2 + 2 + 2 = 9
```

## Enforcement

### During Development
- All new functions MUST have complexity â‰¤ 15
- AI assistants must calculate and report complexity when writing functions
- Complex functions should be broken down using helper methods

### During Code Review
- Functions with complexity > 15 will be rejected
- Refactoring suggestions must be provided

### Refactoring Strategies
When complexity exceeds 15, consider:

1. **Extract Method**: Move complex logic into smaller helper functions
2. **Early Returns**: Use guard clauses to reduce nesting
3. **Strategy Pattern**: Replace complex conditionals with polymorphism
4. **Lookup Tables/Maps**: Replace long if-else chains with data structures
5. **Simplify Boolean Logic**: Use De Morgan's laws to simplify conditions

## Tools
- SonarQube/SonarLint plugins for automatic detection
- AI assistants must report complexity when requested

## References
- SonarQube Cognitive Complexity whitepaper (2023)
- This rule applies to all languages: TypeScript, JavaScript, Python, etc.
